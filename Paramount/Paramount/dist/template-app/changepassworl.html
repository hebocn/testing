<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <title>homepage</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style_homepage.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
  </head>
  <body style="-webkit-app-region: drag">
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 navbar-expand-md">
        <div class="navbar-brand d-flex align-items-center justify-content-between col-sm-12 col-md-2 mr-0">
            <a class="mr-1 d-md-none text-light" href="#sidenav" data-toggle="collapse" data-target="#sidenav">
                <span data-feather="menu" class="my-1"></span>
            </a>
            <a class="text-light" href="">Company</a>
            <a class="navbar-toggler border-0 p-0" href="#topnav" data-toggle="collapse" data-target="#topnav">
                <span data-feather="menu" class="my-1"></span>
            </a>
        </div>
        <div class="navbar-collapse collapse" id="topnav">
            <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
            <ul class="navbar-nav px-3 py-2">
                <li class="nav-item text-nowrap">
                    <a class="nav-link" href="index.html">Sign out</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row navbar-expand-md">
            <nav class="col-md-3 col-lg-2 bg-light navbar-collapse collapse sidebar" id="sidenav">
                <div class="sidebar-sticky flex-column w-100 mt-1">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="home_allfiles.html">
                                <span data-feather="home"></span> All files <span class="sr-only">(current)</span>
                            </a>
                        </li>
                    
                    </ul>

                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                  <span>Transfer list</span>
                  <a class="d-flex align-items-center text-muted" href="#">
                    <span data-feather="plus-circle"></span>
                  </a>
                </h6>
                    <ul class="nav flex-column mb-2">
                        <li class="nav-item">
                            <a class="nav-link" href="home_uploading.html">
                                <span data-feather="file-text"></span> Uploading files
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="home_downloading.html">
                                <span data-feather="file-text"></span> Downloading files
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="home_transfer.html">
                                <span data-feather="file-text"></span> Transfer finished    
                            </a>
                        </li>
                        
                        
                 <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>Account management</span>
                  <a class="d-flex align-items-center text-muted" href="#">
                    <span data-feather="plus-circle"></span>
                  </a></h6>
                        <li class="nav-item">
                            <a class="nav-link" href="changepassworl.html">
                                <span data-feather="file-text">Change Password</span> 
                            </a>
                        </li>
                        
                         
                    </ul>
                </div>
            </nav>

            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
                    <h1 class="h2">Change Password</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group mr-2">
                       
                        </div>
                        <button class="btn btn-sm btn-outline-secondary dropdown-toggle">
                            <span data-feather="calendar"></span> This week
                        </button>
                    </div>
                </div>



                <h2>Section title</h2>




                <div class="table-responsive">
                    <table class="table table-striped table-sm">

                       <html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>修改密码</title>
<link rel="stylesheet" type="text/css" href="res/bootstrap.min.css"/>
<script type="text/javascript" src="res/jquery-1.3.2.min.js"></script>

<script type="text/javascript">
	$(document).ready(function(){
		var error = false;
		
		$("#username").blur(function(){
			var username = $("#username").val();
			if(username == '') {
				showError('username', '账户不能为空');
				error = true;
				return;
			}
			
			$.post("modifyPassProcess.php", {flag:1, username:username}, function(data){
				if(data) {
					$("#username").css({"border-color":"green"});
					$("#usernameTip").css({"display":"none"});
				} else {
					showError('username', '账户不存在');
					error = true;
				}
			});
		});

		$("#oldpass").blur(function(){
			var username = $("#username").val();
			if(username=='') {
				showError('username', '账户不能为空');
				error = true;
				return;
			}

			var oldpass = $("#oldpass").val();
			if(oldpass =='') {
				showError('oldpass', '密码不能为空');
				error = true;
				return;
			}

			$.post("modifyPassProcess.php", {flag:2, username:username, oldpass:oldpass}, function(data){
				if(data) {
					$("#oldpass").css({"border-color":"green"});
					$("#oldpassTip").css({"display":"none"});
				} else {
					showError('oldpass', '密码错误');
					error = true;
				}
			});
		});

		$("#newpass").blur(function(){
			var newpass = $("#newpass").val();
			if(newpass == '') {
				showError('newpass', '新密码不能为空');
				error = true;
			}
			else {
				$("#newpass").css({"border-color":"green"});
				$("#newpassTip").css({"display":"none"});
			}
		});

		$("#newpassAgain").blur(function(){
			var newpass = $("#newpass").val();
			if(newpass == '') {
				showError('newpass', '新密码不能为空');
				error = true;
				return;
			}

			var newpassAgain = $("#newpassAgain").val();
			if(newpassAgain != newpass) {
				showError('newpassAgain', '与输入的新密码不一致');
				error = true;
			}
			else {
				$("#newpassAgain").css({"border-color":"green"});
				$("#newpassAgainTip").css({"display":"none"});
			}
		});
		
		$("#submit").click(function(event){
			$("#username").blur();
			$("#oldpass").blur();
			$("#newpass").blur();
			$("#newpassAgain").blur();

			if(!error) {
				var username = $("#username").val();			
				var newpass = $("#newpass").val();
				$.post('modifyPassProcess.php', {flag:3, username:username, newpass:newpass}, function(data) {
					$("#modifySuccess").css({'display':'inline'});
				});
			}

			event.preventDefault();
			return false;
		});
	});

	function showError(formSpan, errorText) {
		$("#" + formSpan).css({"border-color":"red"});
		$("#" + formSpan + "Tip").empty();
		$("#" + formSpan + "Tip").append(errorText);;
		$("#" + formSpan + "Tip").css({"display":"inline"});
	}
</script>
</head>
<body>

<div class=".container" style="margin-top:100px;width:250%;">
	<form class="form-horizontal" role="form">
	  <div class="form-group">
	    <label for="username" class="col-sm-2 control-label">账户</label>
	    <div class="col-sm-10">
	      <input type="text" class="form-control" style="width:250px;" id="username" placeholder="Username"><span id="usernameTip" style="display:none;color:red;"></span>
	    </div>
	  </div>
	  <div class="form-group">
	    <label for="oldpass" class="col-sm-2 control-label">旧密码</label>
	    <div class="col-sm-10">
	      <input type="password" class="form-control" style="width:250px;" id="oldpass" placeholder="Old Password"><span id="oldpassTip" style="display:none;color:red;"></span>
	    </div>
	  </div>
	  <div class="form-group">
	    <label for="newpass" class="col-sm-2 control-label">新密码</label>
	    <div class="col-sm-10">
	      <input type="password" class="form-control" style="width:250px;" id="newpass" placeholder="New Password"><span id="newpassTip" style="display:none;color:red;"></span>
	    </div>
	  </div>
	  <div class="form-group">
	    <label for="newpassAgain" class="col-sm-2 control-label">再次确认新密码</label>
	    <div class="col-sm-10">
	      <input type="password" class="form-control" style="width:250px;" id="newpassAgain" placeholder="Again New Password"><span id="newpassAgainTip" style="display:none;color:red;"></span>
	    </div>
	  </div>
	  <div class="form-group">
	    <label class="col-sm-2 control-label">  </label>
	 	 <button type="submit" class="btn btn-primary" id="submit" style="text-align:center;">确认修改</button>
	  </div>
	</form>
</div>
<div id="modifySuccess" class="alert alert-success alert-dismissable" style="width:50%;margin-left:40%;display:none;">
  <strong>Success!</strong> 你已成功修改密码！
</div>
</body>
</html>


            
        </div>
    </div>
</main>
  </body>
</html>
